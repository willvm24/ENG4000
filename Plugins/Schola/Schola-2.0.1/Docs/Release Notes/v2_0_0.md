# What's New in v2?

## Flexible Inference Architecture with Agent/Policy/Stepper System

AMD Schola v2 introduces a powerful and flexible architecture that decouples the inference process into components for maximum flexibility and reusability. This modular design allows you to mix and match different policies, stepping strategies, and agent implementations to suit your specific needs.

**Key Components:**

- **Agent Interface** - Define what can be controlled by an inference policy
  - `UInferenceComponent` - Add inference to any actor
  - `AInferencePawn` - Standalone pawn-based agents
  - `AInferenceController` - AI controller pattern for complex behaviors

- **Policy Interface** - Plug in different inference backends
  - `UNNEPolicy` - Native ONNX inference with Unreal Engine's Neural Network Engine
  - `UBlueprintPolicy` - Custom Blueprint-based decision making
  - Extensible interface for custom policy implementations

- **Stepper Objects** - Control inference execution patterns
  - `SimpleStepper` - Synchronous, straightforward inference
  - `PipelinedStepper` - Overlap inference with simulation for better throughput
  - Build custom steppers for specialized performance requirements

This architecture means you can easily **switch between inference backends**, **optimize performance characteristics**, and **compose behaviors** without rewriting your agent logic. Whether you're prototyping with Blueprints or deploying production-ready neural networks, the same agent interface works seamlessly with your chosen policy and execution strategy.

## Minari Dataset Support

AMD Schola v2 introduces native support for the **Minari dataset format**, the standard for offline RL and imitation learning datasets. Minari provides a unified interface for storing and loading trajectory data, making it easier to share demonstrations and datasets across different projects and research communities.

## Dynamic Agent Management

One of the most powerful improvements in AMD Schola v2 is robust support for **agents being spawned and deleted mid-episode**. Previous versions required a static set of agents throughout an episode, or a predefined spawning function to spawn agents but v2 can now handle dynamic populations seamlessly.

This enables realistic scenarios like:

- **Battle Royale / Survival Games** - Agents can be eliminated and removed from training without breaking the episode
- **Population Simulations** - Spawn new agents based on game events or environmental triggers
- **Dynamic Team Composition** - Add or remove team members on the fly
- **Procedural Scenarios** - Dynamically create agents as players progress through procedurally generated content

The system lets you manage lifecycles the way you want, simply mark the agents as terminated when they die, or start reporting observations when they spawn. This makes it much easier to build realistic, dynamic environments that mirror actual game scenarios.

## Enhanced Command-Line Interface

Training from the command line is now more intuitive than ever:

```bash
# Stable Baselines 3
schola sb3 train ppo ...
schola sb3 export ...

# Ray RLlib
schola rllib train ppo ...
schola rllib export ...

# Utilities
schola compile-proto
schola build-docs
```

The new CLI built with `cyclopts` provides better error messages, auto-completion support, and a more consistent interface across different RL frameworks.

## Blueprint Improvements

Working in Blueprints is smoother than ever:

- **Instanced Struct Based Objects** Full Blueprint Support for all points and spaces
- **Enhanced Blueprint Utilities** for spaces and points

## Updated Framework Support

AMD Schola v2 has been updated to support the latest versions of all major RL frameworks and libraries:

- **Gymnasium** - Full support for the latest Gymnasium API (1.1+)
- **Ray RLlib New API Stack** - Compatible with the latest Ray RLlib features and algorithms
- **Stable-Baselines3 2.x** - Updated to work with the newest SB3 release

These updates ensure you can leverage the latest features, bug fixes, and performance improvements from the RL ecosystem while training your agents in Unreal Engine.

## Prerequisites

- Unreal® Engine 5.5+ (tested with 5.5 - 5.6)
- Python 3.10-3.12
- Visual Studio® 2022 with MSVC v143 build tools (Microsoft Windows®)

## Compatibility

| Schola Version | Unreal Engine | Python | Status |
|----------------|---------------|--------|--------|
| 2.0.x          | 5.5-5.6       | 3.9-3.12 | ✅ Current |
| 1.3            | 5.5-5.6       | 3.9-3.11 | Legacy |
| 1.2            | 5.5           | 3.9-3.11 | Legacy |


## Acknowledgments

AMD Schola v2 is the result of contributions from the AMD Software Technologies team, especially Tian Yue Liu, Mehdi Saeedi, and Nathan Hung. Special thanks to all contributors who have helped make this release possible.

---

*Schola is developed by AMD and released as part of the GPUOpen initiative. For more information about AMD's open-source tools and libraries, visit [gpuopen.com](https://gpuopen.com/).*

